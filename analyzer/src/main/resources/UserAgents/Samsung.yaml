#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
config:

# Based partially upon these specifications:
# https://www.samsungdforum.com/SamsungDForum/NewsView?newsID=70
# http://developer.samsung.com/technical-doc/view.do?v=T000000202
# http://developer.samsung.com/technical-doc/view.do?v=T000000203

# SamsungBrowser
- matcher:
    extract:
    - 'DeviceBrand           :   100:"Samsung"' # (Google/AWS/Asure) / Samsung / Apple / ...
    - 'AgentClass            :   2015:"Browser"' # Hacker / Robot / Browser / ...
    - 'AgentName             :   2015:"SamsungBrowser"' # ( GoogleBot / Bing / Yahoo / ...) / ( Firefox / Chrome / ... )
    - 'AgentVersion          :   2015:agent.(3)product.(1)name="SamsungBrowser"^.version' # 4.0 / 43.1.2.3 / ...

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SAMSUNG SM-G920F/G920FXXEinterim Build/MMB29K) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/4.0 Chrome/44.0.2403.133 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '44.0'
      LayoutEngineVersionMajor             : '44'
      LayoutEngineNameVersion              : 'Blink 44.0'
      LayoutEngineNameVersionMajor         : 'Blink 44'
      AgentClass                           : 'Browser'
      AgentName                            : 'SamsungBrowser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'SamsungBrowser 4.0'
      AgentNameVersionMajor                : 'SamsungBrowser 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SAMSUNG SM-G920F Build/MMB29K) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/3.0 Chrome/38.0.2125.102 Mobile VR Safari/537.36'
    expected:
      DeviceClass                          : 'Virtual Reality'
      DeviceName                           : 'SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '38.0'
      LayoutEngineVersionMajor             : '38'
      LayoutEngineNameVersion              : 'Blink 38.0'
      LayoutEngineNameVersionMajor         : 'Blink 38'
      AgentClass                           : 'Browser'
      AgentName                            : 'SamsungBrowser'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'SamsungBrowser 3.0'
      AgentNameVersionMajor                : 'SamsungBrowser 3'


#Kik/9.4.0.4292 (Android 5.0.2) Mozilla/5.0 (Linux; Android 5.0.2; SM-G850F Build/LRX22G; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/47.0.2526.100 Mobile Safari/537.36

#Mozilla/5.0 (Linux; U; Android 4.0.4; pl-pl; GT-P5100 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30
#Mozilla/5.0 (Linux; U; Android 4.0.4; nl-nl; SAMSUNG GT-I9300/I9300BUALF1 Build/IMM76D) AppleWebKit/534.30 (KHTML,

- matcher:
    require:
    - 'agent.(1)product.(1)name="SAMSUNG"'
    extract:
    - 'DeviceClass           :   1:"Mobile"'
    - 'DeviceBrand           :   1:"Samsung"'
    - 'DeviceName            :   1:agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'SAMSUNG GT-S3332 Opera/9.80 (J2ME/MIDP; Opera Mini/7.1.32840/37.7936; U; en) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'GT-S3332'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '7.1.32840'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera Mini 7.1.32840'
      AgentNameVersionMajor                : 'Opera Mini 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (SmartHub; SMART-TV; U; Linux/SmartTV) AppleWebKit/531.2+ (KHTML, like Gecko) WebBrowser/1.0 SmartTV Safari/531.2+'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Smart TV'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'SmartTV'
      OperatingSystemNameVersion           : 'Linux SmartTV'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '531.2'
      LayoutEngineVersionMajor             : '531'
      LayoutEngineNameVersion              : 'AppleWebKit 531.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 531'
      AgentClass                           : 'Browser'
      AgentName                            : 'WebBrowser'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'WebBrowser 1.0'
      AgentNameVersionMajor                : 'WebBrowser 1'
      AgentSecurity                        : 'Strong security'

- matcher:
    extract:
    - 'DeviceClass           :   100:"Mobile"'
    - 'DeviceBrand           :   100:"Samsung"'
    - 'DeviceName            :   100:agent.(1)product.(1)comments.entry.(1)product.(1)name="SAMSUNG"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Tizen 2.3; SAMSUNG SM-Z130H) AppleWebKit/537.3 (KHTML, like Gecko) SamsungBrowser/1.0 Mobile Safari/537.3'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'SM-Z130H'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Tizen'
      OperatingSystemVersion               : '2.3'
      OperatingSystemNameVersion           : 'Tizen 2.3'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.3'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.3'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'SamsungBrowser'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'SamsungBrowser 1.0'
      AgentNameVersionMajor                : 'SamsungBrowser 1'


- matcher:
    require:
    - 'agent.product.(1)name#2="Mobile VR"'
    extract:
    - 'DeviceClass           :   500:"Virtual Reality"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.0.2; SAMSUNG SM-G925K Build/LRX22G) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/4.0 Chrome/44.0.2403.133 Mobile VR Safari/537.36'
    expected:
      DeviceClass                          : 'Virtual Reality'
      DeviceName                           : 'SM-G925K'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '44.0'
      LayoutEngineVersionMajor             : '44'
      LayoutEngineNameVersion              : 'Blink 44.0'
      LayoutEngineNameVersionMajor         : 'Blink 44'
      AgentClass                           : 'Browser'
      AgentName                            : 'SamsungBrowser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'SamsungBrowser 4.0'
      AgentNameVersionMajor                : 'SamsungBrowser 4'



