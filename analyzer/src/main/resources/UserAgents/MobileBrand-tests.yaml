#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

config:

# Base rule if we do not know the brand pattern
- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   81:agent.(1-2)product.(1)comments.entry.product.name="Build"^^[1]'
    - 'DeviceName                  :   81:agent.(1-2)product.(1)comments.entry.product.name="Build"^<'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   82:agent.(1-2)product.(1)comments.entry.product.name="Build"^<<[1]'
    - 'DeviceName                  :   82:agent.(1-2)product.(1)comments.entry.product.name="Build"^<<'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   83:agent.(1-2)product.(1)comments.entry.product.name="Build"^<<<[1]'
    - 'DeviceName                  :   83:agent.(1-2)product.(1)comments.entry.product.name="Build"^<<<'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:"Unknown"'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[2]="Build"@[1]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[3]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[3]="Build"@[1-2]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[4]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[4]="Build"@[1-3]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[5]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[5]="Build"@[1-4]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[5]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[5]="Build"@[1-4]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[6]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[6]="Build"@[1-5]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[7]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[7]="Build"@[1-6]'

- matcher:
    extract:
    - 'DeviceClass                 :    1:"Mobile"'
    - 'DeviceBrand                 :   91:agent.(1-2)product.(1)comments.entry[8]="Build"@[1]'
    - 'DeviceName                  :   91:agent.(1-2)product.(1)comments.entry[8]="Build"@[1-7]'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.0.1; LG-H440n/V10e Build/LRX21Y) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/38.0.2125.102 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'LG-H440n/V10e'
      DeviceBrand                          : 'LG'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.1'
      OperatingSystemNameVersion           : 'Android 5.0.1'
      OperatingSystemVersionBuild          : 'LRX21Y'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '38.0'
      LayoutEngineVersionMajor             : '38'
      LayoutEngineNameVersion              : 'Blink 38.0'
      LayoutEngineNameVersionMajor         : 'Blink 38'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '38.0.2125.102'
      AgentVersionMajor                    : '38'
      AgentNameVersion                     : 'Chrome Webview 38.0.2125.102'
      AgentNameVersionMajor                : 'Chrome Webview 38'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.0.1; LG-D850 Build/LRX21Y) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/37.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'LG-D850'
      DeviceBrand                          : 'LG'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.1'
      OperatingSystemNameVersion           : 'Android 5.0.1'
      OperatingSystemVersionBuild          : 'LRX21Y'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '37.0'
      LayoutEngineVersionMajor             : '37'
      LayoutEngineNameVersion              : 'Blink 37.0'
      LayoutEngineNameVersionMajor         : 'Blink 37'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '37.0.0.0'
      AgentVersionMajor                    : '37'
      AgentNameVersion                     : 'Chrome Webview 37.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 37'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; Doro 8030/8031/8028 Build/EU_RET_01.01.01) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.81 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Doro 8030/8031/8028'
      DeviceBrand                          : 'Doro'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemVersionBuild          : 'EU_RET_01.01.01'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '51.0'
      LayoutEngineVersionMajor             : '51'
      LayoutEngineNameVersion              : 'Blink 51.0'
      LayoutEngineNameVersionMajor         : 'Blink 51'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '51.0.2704.81'
      AgentVersionMajor                    : '51'
      AgentNameVersion                     : 'Chrome 51.0.2704.81'
      AgentNameVersionMajor                : 'Chrome 51'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.3; en-US; Archos_80_Helium_4G Build/JLS36C) AppleWebKit/528.5+ (KHTML, like Gecko) Version/3.1.2 Mobile Safari/525.20.1 UCBrowser/10.3.0.622 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Archos_80_Helium_4G'
      DeviceBrand                          : 'Archos'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.3'
      OperatingSystemNameVersion           : 'Android 4.3'
      OperatingSystemVersionBuild          : 'JLS36C'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '10.3.0.622'
      LayoutEngineVersionMajor             : '10'
      LayoutEngineNameVersion              : 'UCBrowser 10.3.0.622'
      LayoutEngineNameVersionMajor         : 'UCBrowser 10'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '10.3.0.622'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'UCBrowser 10.3.0.622'
      AgentNameVersionMajor                : 'UCBrowser 10'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.3; nl-nl; Archos 50 Helium 4G Build/JLS36C) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Archos 50 Helium 4G'
      DeviceBrand                          : 'Archos'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.3'
      OperatingSystemNameVersion           : 'Android 4.3'
      OperatingSystemVersionBuild          : 'JLS36C'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.2.2; nl-nl; ARCHOS 79 Platinum Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'ARCHOS 79 Platinum'
      DeviceBrand                          : 'Archos'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'
