# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

config:
# ========================================================================
  - matcher:
#      options:
#        - 'verbose'
      require:
        - 'agent.(1)product.(1)name="Name"'
        - 'agent.(1)product.(1)version="V1"'
        - 'agent.(1)product.(2)version="V2"'
        - 'agent.(1)product.(1)comments.(1)entry.(1)product="Versi0nName 1.0 (comment)"'
        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)name="Versi0nName"'
        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)version="1.0"'
        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)comments="(comment)"'
        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)comments.entry.(1)text="comment"'
        - 'agent.(1)product.(1)comments.(2)entry.(1)comments.entry.(1)text="nested comment"'
        - 'agent.(1)product.(1)comments.(3)entry.(1)email="em@il.nl"'
        - 'agent.(1)product.(1)comments.(4)entry.(1)url="http://web.site"'
        - 'agent.(1)product.(1)comments.(5)entry.(1)keyvalue.(1)key="keyText"'
        - 'agent.(1)product.(1)comments.(5)entry.(1)keyvalue.(2)text="text"'
        - 'agent.(1)product.(1)comments.(6)entry.(1)keyvalue.(1)key="keyEmail"'
        - 'agent.(1)product.(1)comments.(6)entry.(1)keyvalue.(2)email="em@il.nl"'
        - 'agent.(1)product.(1)comments.(7)entry.(1)keyvalue.(1)key="keyWeb"'
        - 'agent.(1)product.(1)comments.(7)entry.(1)keyvalue.(2)url="http://web.site"'
        - 'agent.(1)product.(1)comments.(8)entry.(1)keyvalue.(1)key="keyUuid"'
        - 'agent.(1)product.(1)comments.(8)entry.(1)keyvalue.(2)uuid="A43F3165-FAC1-11E1-8828-00123F6EDBB1"'
      extract:
        - 'Test1:1:"Ok"'

  - test:
#      options:
#        - 'verbose'
      input:
        name: 'Comment fields'
        user_agent_string:  'Name V1/V2 (Versi0nName 1.0 (comment); (nested comment) ; em@il.nl ; http://web.site ; keyText=text ; keyEmail=em@il.nl ; keyWeb=http://web.site ; keyUuid={A43F3165-FAC1-11E1-8828-00123F6EDBB1})'
      expected:
        Test1: "Ok"

# ========================================================================

  - matcher:
      options:
#        - 'verbose'
      require:
        - 'agent="TextName 1 (a) Versi0nName 2 (b) em@il.name 3 (c) http://url.name "'
        - 'agent.(1)product.(1)name="TextName"'
        - 'agent.(1)product.(1)version="1"'
        - 'agent.(1)product.(1)comments.entry.(1)text="a"'
        - 'agent.(2)product="Versi0nName 2 (b)"'
        - 'agent.(2)product.(1)name="Versi0nName"'
        - 'agent.(2)product.(1)version="2"'
        - 'agent.(2)product.(1)comments.entry.(1)text="b"'
        - 'agent.(3)product.(1)name="em@il.name"'
        - 'agent.(3)product.(1)name.(1)email="em@il.name"'
        - 'agent.(3)product.(1)version="3"'
        - 'agent.(3)product.(1)comments.entry.(1)text="c"'
      extract:
        - 'Test2:1:"Ok"'

  - test:
      options:
#        - 'init'
#        - 'verbose'
      input:
        name: 'Product name variations'
        user_agent_string:  'TextName 1 (a) Versi0nName 2 (b) em@il.name 3 (c) http://url.name '
      expected:
        Test2: "Ok"

# ========================================================================

  - matcher:
#      options:
#        - 'verbose'
      require:
        - 'agent.(1)product.(1)name.(1)key="keyText"'
        - 'agent.(1)product.(1)name.(2)text="text"'
        - 'agent.(1)product.(1)comments.entry.(1)text="a"'

        - 'agent.(2)product.(1)name.(1)key="keyEmail"'
        - 'agent.(2)product.(1)name.(2)email="em@il.nl"'
        - 'agent.(2)product.(1)comments.entry.(1)text="b"'

        - 'agent.(3)product.(1)name.(1)key="keyWeb"'
        - 'agent.(3)product.(1)name.(2)url="http://web.site"'
        - 'agent.(3)product.(1)comments.entry.(1)text="c"'

        - 'agent.(4)product.(1)name.(1)key="keyUuid"'
        - 'agent.(4)product.(1)name.(2)uuid="A43F3165-FAC1-11E1-8828-00123F6EDBB1"'
        - 'agent.(4)product.(1)comments.entry.(1)text="d"'
      extract:
        - 'Test3:1:"Ok"'


  - test:
      options:
#        - 'init'
#        - 'verbose'
      input:
        name: 'Product name variations (KeyValue)'
        user_agent_string:  'keyText=text (a) keyEmail=em@il.nl (b) keyWeb=http://web.site (c) keyUuid={A43F3165-FAC1-11E1-8828-00123F6EDBB1} (d)'
      expected:
        Test3: "Ok"

# ========================================================================
