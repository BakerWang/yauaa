#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

config:

# Hybrid Broadcast Broadband TV

#According to HbbTV specification http://www.etsi.org/deliver/etsi_ts/102700_102799/102796/01.01.01_60/ts_102796v010101p.pdf the User-Agent shall include:
#HbbTV/1.1.1 (&lt;capabilities&gt;; [&lt;vendorName&gt;]; [&lt;modelName&gt;]; [&lt;softwareVersion&gt;]; [&lt;hardwareVersion&gt;]; &lt;reserved&gt;)


#7.3.2.4 HTTP User-Agent header
#All outgoing HTTP requests made on behalf of an Hybrid Broadcast Broadband TV application shall include a
#User-Agent header using the syntax described in this clause.
#The User-Agent header shall include:
#HbbTV/1.1.1 (&lt;capabilities&gt;; [&lt;vendorName&gt;]; [&lt;modelName&gt;]; [&lt;softwareVersion&gt;];
#[&lt;hardwareVersion&gt;]; &lt;reserved&gt;)
#Where:
#• The &lt;capabilities&gt; field consists of zero or more concatenated Hybrid Broadcast Broadband TV option
#strings as defined in clause 10.2.4.
#• The &lt;vendorName&gt;, &lt;modelName&gt;, &lt;softwareVersion&gt; and &lt;hardwareVersion&gt; fields are the same as the one
#defined in the application/oipfRemoteManagement object in the OIPF DAE specification [2] and are
#optional.
#• The &lt;reserved&gt; field is reserved for future extensions.
#
#10.2.4 Hybrid Broadcast Broadband TV option strings
#The strings defined in this clause shall be used to indicate which options are supported by a terminal. They shall be used
#in the HTTP User-Agent header for applications data retrieval through HTTP and as parameters of a JavaScript API to
#dynamically query the options supported by the terminal.
#NOTE: Some of the strings defined in the clause intentionally match with the "UI Profile Name Fragment" strings
#defined in the OIPF DAE specification [2].
#Table 16: Hybrid Broadcast Broadband TV Option Strings
#Option string Meaning
#"+DL" Support for file download feature
#"+PVR" Support for PVR feature
#"+RTSP" Support for RTSP streaming feature

  - matcher:
      require:
        - 'agent.(1)product.(1)comments.entry.(1)product.(1)name="HbbTV"'
      extract:
        - 'DeviceClass           : 1000:"TV"'
        - 'DeviceBrand           :  100:"Unspecified TV"'
        - 'DeviceName            :  100:"Unspecified TV"'
        - 'OperatingSystemClass  : 1000:"Embedded"'
        - 'OperatingSystemName   :    1:"Proprietary"'

  - matcher:
      extract:
        - 'DeviceBrand           : 1000:agent.(1)product.(1)comments.entry.(1)product.(1)name="HbbTV"^.(1)comments.(2)entry!=""'

  - matcher:
      extract:
        - 'DeviceName            : 1000:agent.(1)product.(1)comments.entry.(1)product.(1)name="HbbTV"^.(1)comments.(3)entry!=""'

  - matcher:
      extract:
        - 'OperatingSystemVersion: 1000:agent.(1)product.(1)comments.entry.(1)product.(1)name="HbbTV"^.(1)comments.(4)entry!=""'

  - matcher:
      extract:
        - 'OperatingSystemName   : 1001:agent.(1)product.(1)comments.entry.(1)product.(1)name="HbbTV"^.(1)comments.(4)entry.product.name'
        - 'OperatingSystemVersion: 1001:agent.(1)product.(1)comments.entry.(1)product.(1)name="HbbTV"^.(1)comments.(4)entry.product.version'


  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux mips; U; HbbTV/1.1.1 (; Philips; ; ; ; ) CE-HTML/1.0 NETTV/4.0.2; en) Presto/2.10.250 Version/11.60'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'Philips'
        DeviceName                           : 'Unspecified TV'
        DeviceCpu                            : 'Mips'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'Mips'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.10.250'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '11.60'
        AgentLanguage                        : 'English'
        AgentSecurity                        : 'Strong security'

  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux armv7l; HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en) ) Presto/2.12.407 Version/12.50'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'Philips'
        DeviceName                           : '47PFT560912'
        DeviceCpu                            : 'ARMv7l'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'ARMv7l'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.12.407'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '12.50'

  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux sh4; U; HbbTV/1.1.1 (+PVR; Loewe; SL150; LOH/3.10;;) CE-HTML/1.0 Config(L:nld,CC:NLD); en) Presto/2.10.250 Version/11.60'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'Loewe'
        DeviceName                           : 'SL150'
        DeviceCpu                            : 'SH4'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'LOH'
        OperatingSystemVersion               : '3.10'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.10.250'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '11.60'
        AgentLanguage                        : 'English'
        AgentSecurity                        : 'Strong security'

  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux mips; U; HbbTV/1.1.1 (; TechniSat; TechniCorder ISIO STC; ; ; ); CE-HTML/1.0 (); TechniSat TechniCorder ISIO STC BCM1 STB; de) Presto/2.9.167 Version/11.50'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'TechniSat'
        DeviceName                           : 'TechniCorder ISIO STC'
        DeviceCpu                            : 'Mips'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'Mips'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.9.167'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '11.50'
        AgentLanguage                        : 'German'
        AgentSecurity                        : 'Strong security'

  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux i686; HbbTV/1.1.1 (+PVR+DRM; BANGOLUFSEN; A3; ; ; ) CE-HTML/1.0 NETTV/4.3.9) Presto/2.12.407 Version/12.50 A3/1.0.8.36666 (BANGOLUFSEN, A3, wireless)'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'BANGOLUFSEN'
        DeviceName                           : 'A3'
        DeviceCpu                            : 'Intel i686'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'Intel i686'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.12.407'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '12.50'

  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux sh4; U; HbbTV/1.1.1(;;;;;); CE-HTML; TechniSat DIGIT ISIO S; en) Presto/2.8.115 Version/11.10'
      expected:
        DeviceClass                          : 'TV'
        DeviceName                           : 'Unspecified TV'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'SH4'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.8.115'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '11.10'
        AgentLanguage                        : 'English'
        AgentSecurity                        : 'Strong security'
        DeviceCpu                            : 'SH4'

  - matcher:
      require:
        - 'agent.(1)product.(1)comments.entry="SMART-TV"'
      extract:
        - 'DeviceClass               : 500 :"TV"'
        - 'DeviceBrand               : 500 :"Samsung"'
        - 'DeviceName                : 500 :"Smart TV"'
        - 'OperatingSystemClass      : 500 :"Embedded"'
        - 'OperatingSystemName       : 500 :"Linux"'
        - 'OperatingSystemVersion    : 500 :"SmartTV"'


#My TV

  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (SmartHub; SMART-TV; U; Linux/SmartTV) AppleWebKit/531.2+ (KHTML, like Gecko) WebBrowser/1.0 SmartTV Safari/531.2+'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'Samsung'
        DeviceName                           : 'Smart TV'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'SmartTV'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'AppleWebKit'
        LayoutEngineVersion                  : '531.2'
        AgentClass                           : 'Browser'
        AgentName                            : 'WebBrowser'
        AgentVersion                         : '1.0'
        AgentSecurity                        : 'Strong security'

  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (SMART-TV; X11; Linux i686) AppleWebKit/535.20+ (KHTML, like Gecko) Version/5.0 Safari/535.20+'
      expected:
        DeviceClass                          : 'TV'
        DeviceBrand                          : 'Samsung'
        DeviceName                           : 'Smart TV'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'SmartTV'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'AppleWebKit'
        LayoutEngineVersion                  : '535.20'
        AgentClass                           : 'Browser'
        AgentName                            : 'Safari'
        AgentVersion                         : '5.0'
        DeviceCpu                            : 'Intel i686'

  - matcher:
      extract:
        - 'OperatingSystemName       : 501 :"Tizen"'
        - 'OperatingSystemVersion    : 501 :agent.(1)product.(1)comments.entry.product.name="Tizen"^.version'


  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (SMART-TV; Linux; Tizen 2.3) AppleWebkit/538.1 (KHTML, like Gecko) SamsungBrowser/1.0 TV Safari/538.1'
      expected:
        DeviceClass                          : 'TV'
        DeviceName                           : 'Smart TV'
        DeviceBrand                          : 'Samsung'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Tizen'
        OperatingSystemVersion               : '2.3'
        OperatingSystemNameVersion           : 'Tizen 2.3'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'AppleWebKit'
        LayoutEngineVersion                  : '538.1'
        LayoutEngineVersionMajor             : '538'
        LayoutEngineNameVersion              : 'AppleWebKit 538.1'
        LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
        AgentClass                           : 'Browser'
        AgentName                            : 'SamsungBrowser'
        AgentVersion                         : '1.0'
        AgentVersionMajor                    : '1'
        AgentNameVersion                     : 'SamsungBrowser 1.0'
        AgentNameVersionMajor                : 'SamsungBrowser 1'

#TODO
#12	29	Opera/9.80 (Linux sh4; U; HbbTV/1.1.1 (+PVR; Loewe; SL150; LOH/3.10;;) CE-HTML/1.0 Config(L:nld,CC:NLD); en) Presto/2.10.250 Version/11.60
#2	5	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; LOEWE; SL22x; LOH/2.4.35.0;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.50
#2	3	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; Loewe; SL22x; LOH/2.4.45.0;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.50
#2	3	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; Loewe; SL22x; LOH/2.4.44.0;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.50
#2	10	Opera/9.80 (Linux i686; HbbTV/1.1.1 (+PVR+DRM; BANGOLUFSEN; A3; ; ; ) CE-HTML/1.0 NETTV/4.3.9) Presto/2.12.407 Version/12.50 A3/1.0.8.36666 (BANGOLUFSEN, A3, wired)
#1	8	Opera/9.80 (Linux armv7l; LOEWE-SL32x/1.1.6.27 HbbTV/1.1.1 (; LOEWE; SL32x; LOH/1.1.6.27;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.51
#1	2	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (;Sharp;LE652;v0.2.6.3;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.50
#1	2	Opera/9.80 (Linux mips; U; HBBTV/1.0; LOH/2.01; CE-HTML/1.0 Config(L:de,CC:DE); en) Presto/2.8.115 Version/11.10
#1	2	Opera/9.80 (Linux i686; HbbTV/1.1.1 (+PVR+DRM; BANGOLUFSEN; A3; ; ; ) CE-HTML/1.0 NETTV/4.3.9) Presto/2.12.407 Version/12.50 A3/1.0.8.36550 (BANGOLUFSEN, A3, wireless)
#1	1	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (;Sharp;LE752;v0.2.4.9;;) CE-HTML/1.0 Config(L:fra,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.50
#1	1	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; Loewe; SL210; LOH/10.2.3.25;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.362 Version/12.10
#1	1	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; Loewe; SL210; LOH/10.2.3.25;;) CE-HTML/1.0 Config(L:nld,CC:BEL) NETRANGEMMH) Presto/2.12.362 Version/12.10
#1	1	Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; Loewe; SL210; LOH/10.2.3.19;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.362 Version/12.10
#1	1	Opera/9.80 (Linux mips; U; HbbTV/1.1.1 (; TechniSat; Digit ISIO S2; ; ; ); CE-HTML/1.0 (); TechniSat Digit ISIO S2 BCM1 STB; nl) Presto/2.9.167 Version/11.50
#1	1	Opera/9.80 (Linux mips; U; HbbTV/1.1.1 (+DL+PVR+RTSP+DRM; ; ; ; ;); en) Presto/2.8.115 Version/11.10
#1	1	Opera/9.80 (Linux i686; HbbTV/1.1.1 (+PVR+DRM; BANGOLUFSEN; A3; ; ; ) CE-HTML/1.0 NETTV/4.3.9) Presto/2.12.407 Version/12.50 A3/1.0.8.36666 (BANGOLUFSEN, A3, wireless)
#1	1	Opera/9.80 (Linux armv7l; LOEWE-SL32x/1.1.6.27 HbbTV/1.1.1 (; LOEWE; SL32x; LOH/1.1.6.27;;) CE-HTML/1.0 Config(L:nld,CC:BEL) NETRANGEMMH) Presto/2.12.407 Version/12.51
#1	1	Opera/9.80 (Linux armv6l; U; NETRANGEMMH;HbbTV/1.1.1;CE-HTML/1.0;PEAQ LF1V368; en) Presto/2.10.250 Version/11.60


#TODO: Extract Philips TV type & firmware !!

  - matcher:
#      options:
#        - 'verbose'
      require:
#        - 'agent="Opera/9.80 (Linux armv7l; HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en) ) Presto/2.12.407 Version/12.50"'
#        - 'agent.(1)product="Opera/9.80 (Linux armv7l; HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en) )"'
#        - 'agent.(1)product.(1)name="Opera"'
#        - 'agent.(1)product.(1)name#1="Opera"'
#        - 'agent.(1)product.(1)name%1="Opera"'
#        - 'agent.(1)product.(1)version="9.80"'
#        - 'agent.(1)product.(1)comments="(Linux armv7l; HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en) )"'
#        - 'agent.(1)product.(1)comments.(1)entry="Linux armv7l"'
#        - 'agent.(1)product.(1)comments.(1)entry#1="Linux"'
#        - 'agent.(1)product.(1)comments.(1)entry%1="Linux"'
#        - 'agent.(1)product.(1)comments.(1)entry#2="Linux armv7l"'
#        - 'agent.(1)product.(1)comments.(1)entry%2="armv7l"'
#        - 'agent.(1)product.(1)comments.(1)entry.(1)product="Linux armv7l"'
#        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)name="Linux"'
#        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)name#1="Linux"'
#        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)name%1="Linux"'
#        - 'agent.(1)product.(1)comments.(1)entry.(1)product.(1)version="armv7l"'
#        - 'agent.(1)product.(1)comments.(2)entry="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en)"'
#        - 'agent.(1)product.(1)comments.(2)entry#1="HbbTV"'
#        - 'agent.(1)product.(1)comments.(2)entry%1="HbbTV"'
#        - 'agent.(1)product.(1)comments.(2)entry#2="HbbTV/1.2.1"'
#        - 'agent.(1)product.(1)comments.(2)entry%2="1.2.1"'
#        - 'agent.(1)product.(1)comments.(2)entry#3="HbbTV/1.2.1 (; Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry%3="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry#4="HbbTV/1.2.1 (; Philips; 47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry%4="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry#5="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry%5="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry#6="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry%6="CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry#7="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0"'
#        - 'agent.(1)product.(1)comments.(2)entry%7="1.0"'
#        - 'agent.(1)product.(1)comments.(2)entry#8="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry%8="NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry#9="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1"'
#        - 'agent.(1)product.(1)comments.(2)entry%9="4.4.1"'
#        - 'agent.(1)product.(1)comments.(2)entry#10="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry%10="SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product="HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en)"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)name="HbbTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)name#1="HbbTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)name%1="HbbTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)version="1.2.1"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments="(; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en)"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(1)entry=""'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(1)entry.(1)text=""'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(2)entry="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(2)entry#1="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(2)entry%1="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(2)entry.(1)text="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(2)entry.(1)text#1="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(2)entry.(1)text%1="Philips"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(3)entry="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(3)entry#1="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(3)entry%1="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(3)entry.(1)text="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(3)entry.(1)text#1="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(3)entry.(1)text%1="47PFT560912"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(4)entry=""'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(4)entry.(1)text=""'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(5)entry="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(5)entry#1="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(5)entry%1="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(5)entry.(1)text="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(5)entry.(1)text#1="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(5)entry.(1)text%1="PHILIPSTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry="CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#1="CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%1="CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#2="CE-HTML/1.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%2="1.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#3="CE-HTML/1.0 NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%3="NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#4="CE-HTML/1.0 NETTV/4.4.1"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%4="4.4.1"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#5="CE-HTML/1.0 NETTV/4.4.1 SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%5="SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#6="CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%6="3.0.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#7="CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%7="Firmware"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#8="CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%8="010.003.002.128"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#9="CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%9="PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry#10="CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry%10="3.1.1,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(1)product="CE-HTML/1.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(1)product.(1)name="CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(1)product.(1)name#1="CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(1)product.(1)name%1="CE-HTML"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(1)product.(1)version="1.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(2)product="NETTV/4.4.1"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(2)product.(1)name="NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(2)product.(1)name#1="NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(2)product.(1)name%1="NETTV"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(2)product.(1)version="4.4.1"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(3)product="SmartTvA/3.0.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(3)product.(1)name="SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(3)product.(1)name#1="SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(3)product.(1)name%1="SmartTvA"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(3)product.(1)version="3.0.0"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product="Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)name="Firmware"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)name#1="Firmware"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)name%1="Firmware"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)version="010.003.002.128"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments="(PhilipsTV, 3.1.1,)"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry="PhilipsTV, 3.1.1,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry#1="PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry%1="PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry#2="PhilipsTV, 3.1.1,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry%2="3.1.1,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry.(1)product="PhilipsTV, 3.1.1,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry.(1)product.(1)name="PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry.(1)product.(1)name#1="PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry.(1)product.(1)name%1="PhilipsTV,"'
#        - 'agent.(1)product.(1)comments.(2)entry.(1)product.(1)comments.(6)entry.(4)product.(1)comments.(1)entry.(1)product.(1)version="3.1.1,"'
      extract:
#        - 'DeviceClass           :   1:'
#        - 'DeviceBrand           :   1:'
#        - 'DeviceName            :   1:'
#        - 'OperatingSystemClass  :   1:' # Cloud, Desktop, Mobile, Embedded
#        - 'OperatingSystemName   :   1:'
#        - 'OperatingSystemVersion:   1:'
#        - 'LayoutEngineClass     :   1:'
#        - 'LayoutEngineName      :   1:'
#        - 'LayoutEngineVersion   :   1:'
#        - 'AgentClass            :   1:'
#        - 'AgentName             :   1:'
#        - 'AgentVersion          :   1:'


  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux armv7l; HbbTV/1.2.1 (; Philips; 47PFT560912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.003.002.128 (PhilipsTV, 3.1.1,)en) ) Presto/2.12.407 Version/12.50'
      expected:
        DeviceClass                          : 'TV'
        DeviceName                           : '47PFT560912'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'ARMv7l'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.12.407'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '12.50'
        DeviceBrand                          : 'Philips'
        DeviceCpu                            : 'ARMv7l'



#148	2660	Mozilla/5.0 (Linux; GoogleTV 3.2; NSZ-GS7/GX70 Build/MASTER) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.77 Safari/534.24
#2	5	Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.77 Large Screen Safari/534.24 GoogleTV/092811
#2	5	Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.77 Large Screen Safari/534.24 GoogleTV/092754
#2	2	Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.77 Large Screen Safari/534.24 GoogleTV/b70199
#1	5	Mozilla/5.0 (Linux; GoogleTV 3.2; hisense_gx1200v Build/MASTER) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.77 Safari/534.24
#1	1	Mozilla/5.0 (Linux; GoogleTV 3.2; GTV100 Build/MASTER) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.77 Safari/534.24
#
#7	12	Mozilla/5.0 (SMART-TV; Linux; Tizen 2.3) AppleWebkit/538.1 (KHTML, like Gecko) SamsungBrowser/1.0 TV Safari/538.1
#1	1	Mozilla/5.0 (Linux; Tizen 2.3; SAMSUNG SM-Z130H) AppleWebKit/537.3 (KHTML, like Gecko) SamsungBrowser/1.0 Mobile Safari/537.3



  - matcher:
      require:
      extract:
        - 'OperatingSystemClass  :  100:"Embedded"'
        - 'DeviceClass           :  100:"TV"'
        - 'DeviceBrand           :  100:"Philips"'
        - 'DeviceName            :  100:"Net TV"'
        - 'DeviceVersion         :  100:agent.(1)product.(1)comments.(3)entry.(2)product.(1)name="NETTV"^.version'

  - test:
      input:
        user_agent_string: 'Opera/9.80 (Linux armv7l; U;  CE-HTML/1.0 NETTV/4.1.1; en) Presto/2.10.287 Version/12.00'
      expected:
        DeviceClass                          : 'TV'
        DeviceName                           : 'Net TV'
        DeviceVersion                        : '4.1.1'
        DeviceBrand                          : 'Philips'
        DeviceCpu                            : 'ARMv7l'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'ARMv7l'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '2.10.287'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '12.00'
        AgentLanguage                        : 'English'
        AgentSecurity                        : 'Strong security'

  - test:
      input:
        user_agent_string: 'Opera/9.70 (Linux armv6l ; U; CE-HTML/1.0 NETTV/2.0.2; en) Presto/2.2.1'
      expected:
        DeviceClass                          : 'TV'
        DeviceName                           : 'Net TV'
        DeviceVersion                        : '2.0.2'
        DeviceBrand                          : 'Philips'
        DeviceCpu                            : 'ARMv6l'
        OperatingSystemClass                 : 'Embedded'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'ARMv6l'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'Presto'
        LayoutEngineVersion                  : '1'
        AgentClass                           : 'Browser'
        AgentName                            : 'Opera'
        AgentVersion                         : '9.70'
        AgentLanguage                        : 'English'
        AgentSecurity                        : 'Strong security'


#1	5	Opera/9.80 WebKit/1.6.3 (CE-HTML/1.0 NETTV 3.3.0 PHILIPS-AVM-2012) PhilipsWebKit/535.4
#1	3	WebKit/4.2.5, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.35 (Philips, BDP5700, wireless)
#1	1	WebKit/4.1.9, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.16 (Philips, HTB5260G, wireless)
#1	1	WebKit/3.9.4, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.30 (Philips, BDP7750, wireless)
#
#
#510     3162    Mozilla/5.0 (Linux; NetCast; U) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.33 Safari/537.31 SmartTV/5.0
#277     1292    Mozilla/5.0 (Linux; NetCast; U) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.79 Safari/537.4 SmartTV/4.6

#
#Opera/9.80 (Linux armv7l; HbbTV/1.2.1 (; Philips; 32PFK550912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.002.016.128 (PhilipsTV, 3.1.1,)en) ) Presto/2.12.407 Version/12.50
#Opera/9.80 (Linux armv7l; HbbTV/1.2.1 (; Philips; 32PFK550912; ; PHILIPSTV;  CE-HTML/1.0 NETTV/4.4.1 SmartTvA/3.0.0 Firmware/010.002.036.128 (PhilipsTV, 3.1.1,)en) ) Presto/2.12.407 Version/12.50
#
#Opera/9.80 (Linux armv7l; InettvBrowser/2.2 (00014A;SonyDTV115;0002;0100) KD55X9005A; CC/BEL) Presto/2.12.362 Version/12.11
#Opera/9.80 (Linux armv7l; InettvBrowser/2.2 (00014A;SonyDTV115;0002;0100) KDL32W605A; CC/BRA) Presto/2.12.362 Version/12.11
#
#
#Opera/9.80 (Linux armv7l; LOEWE-SL32x/1.1.6.27 HbbTV/1.1.1 (; LOEWE; SL32x; LOH/1.1.6.27;;) CE-HTML/1.0 Config(L:nld,CC:BEL) NETRANGEMMH) Presto/2.12.407 Version/12.51
#Opera/9.80 (Linux armv7l; LOEWE-SL32x/1.1.6.27 HbbTV/1.1.1 (; LOEWE; SL32x; LOH/1.1.6.27;;) CE-HTML/1.0 Config(L:nld,CC:NLD) NETRANGEMMH) Presto/2.12.407 Version/12.51
#Opera/9.80 (Linux armv7l ; U; CE-HTML/1.0 NETTV/3.2.2; en) Presto/2.6.33 Version/10.60
#Opera/9.80 (Linux armv7l; U; CE-HTML/1.0 NETTV/3.3.0; PHILIPS-AVM-2012; en) Presto/2.9.167 Version/11.50
#
#Opera/9.80 (Linux i686; HbbTV/1.1.1 (+PVR+DRM; BANGOLUFSEN; A3; ; ; ) CE-HTML/1.0 NETTV/4.3.9) Presto/2.12.407 Version/12.50 A3/1.0.8.36666 (BANGOLUFSEN, A3, wired)
#Opera/9.80 (Linux mips ; U; HbbTV/1.1.1 (; Philips; ; ; ; ) CE-HTML/1.0 NETTV/3.1.0; en) Presto/2.6.33 Version/10.70
#Opera/9.80 (Linux sh4; HbbTV/1.2.1 (+PVR; Loewe; SL210; LOH/10.2.3.25;;) CE-HTML/1.0 Config(L:nld,CC:BEL) NETRANGEMMH) Presto/2.12.362 Version/12.10

