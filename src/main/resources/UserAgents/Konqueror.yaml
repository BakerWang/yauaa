#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

config:

  - matcher:
      extract:
        - 'LayoutEngineClass     : 2000:"Browser"'
        - 'LayoutEngineName      : 2000:"KHTML"'
        - 'LayoutEngineVersion   : 2000:agent.(1)product.comments.entry.product.name="Konqueror"^.version'
        - 'AgentClass            : 2000:"Browser"'
        - 'AgentName             : 2000:"Konqueror"'
        - 'AgentVersion          : 2000:agent.(1)product.comments.entry.product.name="Konqueror"^.version'

  - matcher:
      extract:
        - 'LayoutEngineClass     : 2000:"Browser"'
        - 'LayoutEngineName      : 2001:"KHTML"'
        - 'LayoutEngineVersion   : 2001:agent.product.comments.entry.product.name="KHTML"^.version'

  - matcher:
      extract:
        - 'LayoutEngineClass     : 2000:"Browser"'
        - 'LayoutEngineName      : 2001:"KHTML"'
        - 'LayoutEngineVersion   : 2001:agent.product.name="KHTML"^.version'
        - 'AgentClass            :   50:"Browser"'
        - 'AgentName             :   50:"Konqueror"'
        - 'AgentVersion          :   50:agent.product.name="Konqueror"^.version'


#http://webaim.org/blog/user-agent-string-history/

#Konqueror:
  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.2; FreeBSD) (KHTML, like Gecko)'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'FreeBSD Desktop'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'FreeBSD'
        OperatingSystemVersion               : '??'
        OperatingSystemNameVersion           : 'FreeBSD ??'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'KHTML'
        LayoutEngineVersion                  : '3.2'
        LayoutEngineVersionMajor             : '3'
        LayoutEngineNameVersion              : 'KHTML 3.2'
        LayoutEngineNameVersionMajor         : 'KHTML 3'
        AgentClass                           : 'Browser'
        AgentName                            : 'Konqueror'
        AgentVersion                         : '3.2'
        AgentVersionMajor                    : '3'
        AgentNameVersion                     : 'Konqueror 3.2'
        AgentNameVersionMajor                : 'Konqueror 3'


  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) KHTML/4.8.5 (like Gecko) Konqueror/4.8 Fedora/4.8.5-2.fc16'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'Linux Desktop'
        DeviceCpu                            : 'Intel x86_64'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'Fedora'
        OperatingSystemVersion               : '4.8.5-2.fc16'
        OperatingSystemNameVersion           : 'Fedora 4.8.5-2.fc16'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'KHTML'
        LayoutEngineVersion                  : '4.8.5'
        LayoutEngineVersionMajor             : '4'
        LayoutEngineNameVersion              : 'KHTML 4.8.5'
        LayoutEngineNameVersionMajor         : 'KHTML 4'
        AgentClass                           : 'Browser'
        AgentName                            : 'Konqueror'
        AgentVersion                         : '4.8'
        AgentVersionMajor                    : '4'
        AgentNameVersion                     : 'Konqueror 4.8'
        AgentNameVersionMajor                : 'Konqueror 4'

  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.3 Safari/537.21'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'Linux Desktop'
        DeviceCpu                            : 'Intel x86_64'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'Intel x86_64'
        OperatingSystemNameVersion           : 'Linux Intel x86_64'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'AppleWebKit'
        LayoutEngineVersion                  : '537.21'
        LayoutEngineVersionMajor             : '537'
        LayoutEngineNameVersion              : 'AppleWebKit 537.21'
        LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
        AgentClass                           : 'Browser'
        AgentName                            : 'Safari'            # I think this is Safari, NOT Konqueror
        AgentVersion                         : '537.21'
        AgentVersionMajor                    : '537'
        AgentNameVersion                     : 'Safari 537.21'
        AgentNameVersionMajor                : 'Safari 537'


  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) KHTML/4.8.4 (like Gecko) Konqueror/4.8'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'Linux Desktop'
        DeviceCpu                            : 'Intel x86_64'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : 'Intel x86_64'
        OperatingSystemNameVersion           : 'Linux Intel x86_64'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'KHTML'
        LayoutEngineVersion                  : '4.8.4'
        LayoutEngineVersionMajor             : '4'
        LayoutEngineNameVersion              : 'KHTML 4.8.4'
        LayoutEngineNameVersionMajor         : 'KHTML 4'
        AgentClass                           : 'Browser'
        AgentName                            : 'Konqueror'
        AgentVersion                         : '4.8'
        AgentVersionMajor                    : '4'
        AgentNameVersion                     : 'Konqueror 4.8'
        AgentNameVersionMajor                : 'Konqueror 4'


  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/4.4; Linux) KHTML/4.4.5 (like Gecko)'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'Linux Desktop'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : '??'
        OperatingSystemNameVersion           : 'Linux ??'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'KHTML'
        LayoutEngineVersion                  : '4.4'
        LayoutEngineVersionMajor             : '4'
        LayoutEngineNameVersion              : 'KHTML 4.4'
        LayoutEngineNameVersionMajor         : 'KHTML 4'
        AgentClass                           : 'Browser'
        AgentName                            : 'Konqueror'
        AgentVersion                         : '4.4'
        AgentVersionMajor                    : '4'
        AgentNameVersion                     : 'Konqueror 4.4'
        AgentNameVersionMajor                : 'Konqueror 4'


  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (X11; FreeBSD) KHTML/4.9.1 (like Gecko) Konqueror/4.9'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'FreeBSD Desktop'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'FreeBSD'
        OperatingSystemVersion               : '??'
        OperatingSystemNameVersion           : 'FreeBSD ??'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'KHTML'
        LayoutEngineVersion                  : '4.9.1'
        LayoutEngineVersionMajor             : '4'
        LayoutEngineNameVersion              : 'KHTML 4.9.1'
        LayoutEngineNameVersionMajor         : 'KHTML 4'
        AgentClass                           : 'Browser'
        AgentName                            : 'Konqueror'
        AgentVersion                         : '4.9'
        AgentVersionMajor                    : '4'
        AgentNameVersion                     : 'Konqueror 4.9'
        AgentNameVersionMajor                : 'Konqueror 4'


  - test:
      input:
        user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.1; Linux 2.4.22-4GB-athlon; X11; i686)'
      expected:
        DeviceClass                          : 'Desktop'
        DeviceName                           : 'Linux Desktop'
        DeviceCpu                            : 'Intel i686'
        OperatingSystemClass                 : 'Desktop'
        OperatingSystemName                  : 'Linux'
        OperatingSystemVersion               : '2.4.22-4GB-athlon'
        OperatingSystemNameVersion           : 'Linux 2.4.22-4GB-athlon'
        LayoutEngineClass                    : 'Browser'
        LayoutEngineName                     : 'KHTML'
        LayoutEngineVersion                  : '3.1'
        LayoutEngineVersionMajor             : '3'
        LayoutEngineNameVersion              : 'KHTML 3.1'
        LayoutEngineNameVersionMajor         : 'KHTML 3'
        AgentClass                           : 'Browser'
        AgentName                            : 'Konqueror'
        AgentVersion                         : '3.1'
        AgentVersionMajor                    : '3'
        AgentNameVersion                     : 'Konqueror 3.1'
        AgentNameVersionMajor                : 'Konqueror 3'


